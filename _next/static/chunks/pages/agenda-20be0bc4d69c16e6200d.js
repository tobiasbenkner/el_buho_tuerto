(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[396],{1991:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return ie}});var r=t(7294),i=t(6437),o=t(266),a=t(2809),c=t(6311),s=t(809),l=t.n(s),u=t(3777),d=t(6798),h=t(6351),p=t(9620),f=t(8979),j=t(3258),x=t(2856),g=t(9300),m=t(8105),Z=t(3365),v=t(1655),b=t(4372),y=t(8779),O=t(2557),w=t(4595),C=t(7745),P=t(9144),k=t(149),D=t(8309),S=t(7957),_=t(381),E=t.n(_),I=t(5893);function H(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function M(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?H(Object(t),!0).forEach((function(n){(0,a.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):H(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var A=function(e){var n=r.useState(!1),t=(0,c.Z)(n,2),s=t[0],_=t[1],H=r.useState(!1),A=(0,c.Z)(H,2),N=A[0],W=A[1],Y=(0,r.useState)({date:null,time:null,name:"",person_count:"",contact:"",description:""}),L=Y[0],F=Y[1];(0,r.useEffect)((function(){s&&e.edit&&F(M(M({},e.reservation),{},{time:(0,b.Z)(e.reservation.time,"HH:mm",new Date)}))}),[s]);var R=(0,r.useState)(""),z=R[0],B=R[1],T=(0,r.useState)(!1),X=T[0],q=T[1],V=function(e,n){F((function(t){return M(M({},t),{},(0,a.Z)({},n,e))}))},$=function(){_(!0)},G=function(){F({date:null,time:null,name:"",person_count:"",contact:"",description:""}),_(!1)},J=function(){W(!1)},K=function(){var n=(0,o.Z)(l().mark((function n(){var t,r;return l().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(L.date&&L.time){n.next=2;break}return n.abrupt("return");case 2:q(!0),t="string"===typeof L.date||L.date instanceof String?L.date:(0,y.Z)(L.date,"yyyy-MM-dd"),r="string"===typeof L.time||L.time instanceof String?L.time:(0,y.Z)(L.time,"HH:mm"),e.edit?(0,i.cW)(t,L.id,M(M({},L),{},{time:(0,y.Z)(L.time,"HH:mm")})):(0,i._L)(t,r,L.person_count,L.contact,L.name,L.description),q(!1),B("reserva ".concat(e.edit?"actualizada":"creada"," : ").concat(E()(L.date).format("DD.MM.YYYY")," ").concat(r," ").concat(L.name)),W(!0),G();case 10:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return(0,I.jsxs)("div",{children:[e.edit?(0,I.jsx)(O.Z,{onClick:$,"aria-label":"upload picture",component:"span",children:(0,I.jsx)(S.Z,{})}):(0,I.jsx)(d.Z,{variant:"outlined",onClick:$,startIcon:(0,I.jsx)(D.Z,{}),children:"nueva reserva"}),(0,I.jsx)(w.Z,{open:N,autoHideDuration:6e3,onClose:J,anchorOrigin:{vertical:"top",horizontal:"right"},children:(0,I.jsx)(u.Z,{onClose:J,severity:"info",sx:{width:"100%"},children:z})}),(0,I.jsxs)(p.Z,{open:s,onClose:G,children:[(0,I.jsx)(C.Z,{children:"Nueva reserva"}),(0,I.jsxs)(j.Z,{children:[(0,I.jsxs)(x._,{dateAdapter:Z.H,adapterLocale:v.Z,children:[(0,I.jsx)(g.O,{label:"D\xeda",inputFormat:"dd.MM.yyyy",value:L.date,onChange:function(e){return V(e,"date")},renderInput:function(e){return(0,I.jsx)(h.Z,M(M({},e),{},{margin:"dense",fullWidth:!0}))}}),(0,I.jsx)(m.d,{label:"Hora",ampm:!1,value:L.time,onChange:function(e){V(e,"time")},renderInput:function(e){return(0,I.jsx)(h.Z,M(M({},e),{},{margin:"dense",fullWidth:!0}))}})]}),(0,I.jsx)(h.Z,{margin:"dense",label:"Nombre",type:"text",value:L.name,fullWidth:!0,onChange:function(e){return V(e.target.value,"name")}}),(0,I.jsx)(h.Z,{margin:"dense",value:L.person_count,label:"Personas",type:"text",fullWidth:!0,onChange:function(e){return V(e.target.value,"person_count")}}),(0,I.jsx)(h.Z,{value:L.contact,margin:"dense",label:"Contacto",type:"text",fullWidth:!0,onChange:function(e){return V(e.target.value,"contact")}}),(0,I.jsx)(h.Z,{margin:"dense",value:L.description,label:"Observaciones",type:"text",fullWidth:!0,onChange:function(e){return V(e.target.value,"description")}})]}),X?(0,I.jsx)(P.Z,{alignItems:"end",children:(0,I.jsx)(k.Z,{style:{marginRight:24,marginBottom:20}})}):(0,I.jsxs)(f.Z,{children:[(0,I.jsx)(d.Z,{onClick:G,children:"Cancelar"}),(0,I.jsx)(d.Z,{onClick:K,children:e.edit?"Cambiar":"A\xf1adir"})]})]})]})},N=t(8720),W=t(3951),Y=t(625),L=t(7691);function F(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function R(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?F(Object(t),!0).forEach((function(n){(0,a.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):F(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var z=function(e){var n=(0,L.a)(),t=n.userInfo,i=n.login,c=(0,r.useState)({}),s=c[0],p=c[1],f=(0,r.useState)(!1),j=f[0],x=f[1],g=function(e,n){p((function(t){return R(R({},t),{},(0,a.Z)({},n,e))}))},m=function(){var e=(0,o.Z)(l().mark((function e(n){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,i(s.username,s.password);case 4:x(!1),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),x(!0);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(n){return e.apply(this,arguments)}}();return t.isLoading?(0,I.jsx)(P.Z,{alignItems:"center",children:(0,I.jsx)(k.Z,{})}):t.isAuth?e.children:(0,I.jsx)(N.Z,{component:"form",noValidate:!0,autoComplete:"off",onSubmit:m,children:(0,I.jsxs)(P.Z,{spacing:3,children:[(0,I.jsx)(h.Z,{label:"Correo",onChange:function(e){return g(e.target.value,"username")}}),(0,I.jsx)(h.Z,{label:"Contrase\xf1a",type:"password",onChange:function(e){return g(e.target.value,"password")}}),j&&(0,I.jsx)(u.Z,{severity:"warning",children:"Por favor, compruebe sus datos de acceso"}),(0,I.jsx)(d.Z,{type:"submit",children:"Inicio"})]})})},B=t(7044),T=t(7349),X=t(7929),q=t(8881),V=t(7542),$=t(5369),G=t(9557),J=t(7272),K=t(6948),Q=t(6129),U=t(8364),ee=function(e){var n=e.reservation,t=r.useState(!1),a=(0,c.Z)(t,2),s=a[0],u=a[1],h=function(){u(!1)},x=function(){var e=(0,o.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(),e.next=3,(0,i.CE)(n.date,n.id);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,I.jsxs)("div",{children:[(0,I.jsx)(O.Z,{onClick:function(){u(!0)},"aria-label":"upload picture",component:"span",children:(0,I.jsx)(U.Z,{})}),(0,I.jsxs)(p.Z,{open:s,onClose:h,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,I.jsx)(C.Z,{id:"alert-dialog-title",children:"\xbfRealmente quieres borrar la reserva?"}),(0,I.jsx)(j.Z,{children:(0,I.jsxs)(Q.Z,{id:"alert-dialog-description",children:[E()(n.date).format("DD.MM.YYYY"),(0,I.jsx)("br",{}),n.time,(0,I.jsx)("br",{}),n.name]})}),(0,I.jsxs)(f.Z,{children:[(0,I.jsx)(d.Z,{onClick:h,children:"No"}),(0,I.jsx)(d.Z,{onClick:x,autoFocus:!0,children:"S\xed"})]})]})]})};function ne(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function te(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ne(Object(t),!0).forEach((function(n){(0,a.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ne(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var re=function(e){var n,t,r=e.agenda,o=null===r||void 0===r?void 0:r.date,a=(null===r||void 0===r?void 0:r.reservations)||[],c=function(e){(0,i.D1)(o,e).then((function(){}))};return(0,I.jsx)(X.Z,{component:q.Z,children:(0,I.jsxs)(V.Z,{size:"small",sx:{minWidth:650},"aria-label":"simple table",children:[(0,I.jsx)($.Z,{children:(0,I.jsxs)(G.Z,{children:[(0,I.jsx)(J.Z,{children:"Hora"}),(0,I.jsx)(J.Z,{align:"right",children:"Nombre"}),(0,I.jsx)(J.Z,{align:"right",children:"Personas"}),(0,I.jsx)(J.Z,{align:"right",children:"Contacto"}),(0,I.jsx)(J.Z,{align:"right",children:"Observaciones"}),(0,I.jsx)(J.Z,{align:"center"})]})}),(0,I.jsxs)(K.Z,{children:[null===a||void 0===a||null===(n=a.filter((function(e){return e.time<"19:00"})))||void 0===n?void 0:n.map((function(e){return(0,I.jsxs)(G.Z,{sx:{"&:last-child td, &:last-child th":{border:0},backgroundColor:e.is_there?"#37474F":"none"},style:{},onDoubleClick:function(){return c(e.id)},children:[(0,I.jsx)(J.Z,{width:10,component:"th",scope:"row",children:e.time}),(0,I.jsx)(J.Z,{align:"right",children:e.name}),(0,I.jsx)(J.Z,{align:"right",children:e.person_count}),(0,I.jsx)(J.Z,{align:"right",children:e.contact}),(0,I.jsx)(J.Z,{align:"right",children:e.description}),(0,I.jsx)(J.Z,{width:10,align:"center",children:(0,I.jsxs)(P.Z,{direction:"row",children:[(0,I.jsx)(A,{edit:!0,reservation:te(te({},e),{},{date:o})}),(0,I.jsx)(ee,{reservation:te(te({},e),{},{date:o})})]})})]},e.id)})),0===a.filter((function(e){return e.time<"19:00"})).length&&(0,I.jsx)(G.Z,{children:(0,I.jsx)(J.Z,{colSpan:6,style:{textAlign:"center"},children:"No hay reservas"})}),(0,I.jsx)(G.Z,{sx:{"&:last-child td, &:last-child th":{border:0}},children:(0,I.jsxs)(J.Z,{colSpan:6,width:10,component:"th",scope:"row",style:{textAlign:"center"},children:[(0,I.jsx)("hr",{}),(0,I.jsx)("hr",{})]})}),null===a||void 0===a||null===(t=a.filter((function(e){return e.time>"19:00"})))||void 0===t?void 0:t.map((function(e){return(0,I.jsxs)(G.Z,{sx:{"&:last-child td, &:last-child th":{border:0},backgroundColor:e.is_there?"#37474F":"none"},onDoubleClick:function(){return c(e.id)},children:[(0,I.jsx)(J.Z,{width:10,component:"th",scope:"row",children:e.time}),(0,I.jsx)(J.Z,{align:"right",children:e.name}),(0,I.jsx)(J.Z,{align:"right",children:e.person_count}),(0,I.jsx)(J.Z,{align:"right",children:e.contact}),(0,I.jsx)(J.Z,{align:"right",children:e.description}),(0,I.jsx)(J.Z,{width:10,align:"center",children:(0,I.jsxs)(P.Z,{direction:"row",children:[(0,I.jsx)(A,{edit:!0,reservation:te(te({},e),{},{date:o})}),(0,I.jsx)(ee,{reservation:te(te({},e),{},{date:o})})]})})]},e.id)})),0===a.filter((function(e){return e.time>"19:00"})).length&&(0,I.jsx)(G.Z,{children:(0,I.jsx)(J.Z,{colSpan:6,style:{textAlign:"center"},children:"No hay reservas"})})]})]})})},ie=function(){var e=(0,L.a)().userInfo,n=(0,r.useState)({}),t=n[0],o=n[1],a=(0,r.useState)(new Date),c=a[0],s=a[1],l=(0,r.useState)(!0),u=l[0],h=l[1];(0,r.useEffect)((function(){if(e.isAuth){h(!0);var n=(0,y.Z)(c,"yyyy-MM-dd"),t=(0,i.x8)(n,(function(e){var n,t=e.data();t&&t.reservations&&(t.reservations=null===t||void 0===t||null===(n=t.reservations)||void 0===n?void 0:n.sort((function(e,n){return e.time.localeCompare(n.time)})));o(t),h(!1)}));return function(){t()}}}),[c,e]);var p=function(e){var n=(0,T.Z)(c,e);s(n)};return(0,I.jsxs)("div",{style:{padding:20,maxWidth:1200,marginLeft:"auto",marginRight:"auto"},children:[(0,I.jsx)("h1",{style:{textAlign:"center",marginBottom:40},children:"Agenda"}),(0,I.jsxs)(z,{children:[(0,I.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[(0,I.jsx)("div",{children:(0,I.jsx)(O.Z,{component:"span",onClick:function(){return p(-1)},children:(0,I.jsx)(W.Z,{})})}),(0,I.jsxs)(P.Z,{direction:"row",spacing:2,justifyContent:"center",alignItems:"center",children:[(0,I.jsx)(d.Z,{onClick:function(){s(new Date)},children:"Hoy"}),(0,I.jsx)(x._,{dateAdapter:Z.H,adapterLocale:v.Z,children:(0,I.jsx)(B.$,{value:c,onChange:function(e){s(e)},renderInput:function(e){var n=e.inputRef,t=(e.inputProps,e.InputProps);return(0,I.jsxs)(N.Z,{sx:{display:"flex",alignItems:"center"},children:[null===t||void 0===t?void 0:t.endAdornment,"\xa0\xa0\xa0",(0,I.jsx)("strong",{ref:n,children:(0,y.Z)(c,"dd.MM.yyyy")})]})}})}),(0,I.jsx)(A,{})]}),(0,I.jsx)("div",{children:(0,I.jsx)(O.Z,{component:"span",onClick:function(){return p(1)},children:(0,I.jsx)(Y.Z,{})})})]}),u?(0,I.jsx)(P.Z,{alignItems:"center",children:(0,I.jsx)(k.Z,{})}):(0,I.jsx)(re,{agenda:t})]})]})}},5889:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/agenda",function(){return t(1991)}])}},function(e){e.O(0,[885,682,65,985,774,888,179],(function(){return n=5889,e(e.s=n);var n}));var n=e.O();_N_E=n}]);